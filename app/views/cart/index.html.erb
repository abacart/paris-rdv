<h1>Cart</h1>

<% #@invoice %>
<% if @user_products.empty? && @user_boxes.empty? %>
  <p class="text-info">Your cart is empty.</p>
<% else %>
  <table class="table">
    <tr>
      <th></th>
      <th>Quantity</th>
      <th>Name</th>
      <th>Price</th>
    </tr>
    <% @user_products.each do |up| %>
      <tr>
        <td><%= link_to 'X', remove_product_cart_index_path(up.id), method: :delete %></td>
        <td>
            <%= link_to '-', decrease_product_quantity_cart_index_path(up), method: :patch %>
            <%= up.quantity %>
            <%= link_to '+', increase_product_quantity_cart_index_path(up), method: :patch %>
        </td>
        <td><%= link_to up.product.name, up.product %></td>
        <td><%= number_to_currency up.price %></td>
      </tr>
    <% end %>

    <% @user_boxes.each do |ub| %>
      <tr>
        <td><%= link_to 'X', remove_box_cart_index_path(ub.id), method: :delete %></td>
        <td>
            <%= link_to '-', decrease_box_quantity_cart_index_path(ub), method: :patch %>
            <%= ub.quantity %>
            <%= link_to '+', increase_box_quantity_cart_index_path(ub), method: :patch %>
        </td>
        <td><%= link_to ub.box.name, edit_user_box_path(ub) %>
           <% if !ub.full? %>
              <i class="glyphicon glyphicon-warning-sign"></i>
              <%= link_to 'This box is not full', edit_user_box_path(ub) %>
          <% end %>
        </td>
        <td><%= number_to_currency ub.price %></td>
      </tr>
    <% end %>

    <tr>
      <td></td>
      <td></td>
      <td>Total</td>
      <td><%= number_to_currency current_user.total_cart %></td>
    </tr>
  </table>
<% end %>

